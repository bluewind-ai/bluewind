{
  "version": "2.0.0",
  "tasks": [
    {
      "label": "DEV",
      "type": "shell",
      "command": "(ps aux | grep gunicorn | grep -v grep | awk '{print $2}' | xargs kill -9 )&& source /Users/merwanehamadi/Library/Caches/pypoetry/virtualenvs/bluewind-5kHNo6Af-py3.12/bin/activate && while true; do python local_secrets.py && source .env && env $(cat .env | xargs) ENVIRONMENT=local python manage.py runserver || (terminal-notifier -message \"DEV failed\" -title \"CI Alert\" || notify-send \"CI Alert\" \"DEV failed\"); sleep 1; done",
      "problemMatcher": [],
      "runOptions": {
        "runOn": "folderOpen"
      }
    },
    {
      "label": "prod-blue-e2e",
      "type": "shell",
      "command": "cd ../bluewind-blue && source /Users/merwanehamadi/Library/Caches/pypoetry/virtualenvs/bluewind-5kHNo6Af-py3.12/bin/activate && while true; do python local_secrets.py && source .env && env $(cat .env | xargs) python ci.py e2e_prod || (terminal-notifier -message \"Prod blue E2E test failed\" -title \"CI Alert\" || notify-send \"CI Alert\" \"E2E test failed\"); sleep 1; done",
      "problemMatcher": [],
      "runOptions": {
        "runOn": "folderOpen"
      }
    },
    {
      "label": "prod-blue-pull-main",
      "type": "shell",
      "command": "while true; do cd ../bluewind-blue && git stash && git pull origin main; sleep 10; done",
      "problemMatcher": [],
      "runOptions": {
        "runOn": "folderOpen"
      }
    },
    {
      "label": "prod-green-e2e",
      "type": "shell",
      "command": "source /Users/merwanehamadi/Library/Caches/pypoetry/virtualenvs/bluewind-5kHNo6Af-py3.12/bin/activate && while true; do python local_secrets.py && source .env && env $(cat .env | xargs) python ci.py e2e_prod_green || (terminal-notifier -message \"Prod Green E2E test failed\" -title \"CI Alert\" || notify-send \"CI Alert\" \"Prod Green E2E test failed\"); sleep 1; done",
      "problemMatcher": [],
      "runOptions": {
        "runOn": "folderOpen"
      }
    },
    {
      "label": "dev-green-server",
      "type": "shell",
      "command": "(ps aux | grep gunicorn | grep -v grep | awk '{print $2}' | xargs kill -9 )&& source /Users/merwanehamadi/Library/Caches/pypoetry/virtualenvs/bluewind-5kHNo6Af-py3.12/bin/activate && while true; do python local_secrets.py && source .env && env $(cat .env | xargs) ENVIRONMENT=local python manage.py runserver localhost:8001 || (terminal-notifier -message \"Dev Green Server failed\" -title \"CI Alert\" || notify-send \"CI Alert\" \"Dev Green Server test failed\"); sleep 1; done",
      "problemMatcher": [],
      "runOptions": {
        "runOn": "folderOpen"
      }
    },
    {
      "label": "e2e-dev-green",
      "type": "shell",
      "command": "(ps aux | grep gunicorn | grep -v grep | awk '{print $2}' | xargs kill -9 )&& source /Users/merwanehamadi/Library/Caches/pypoetry/virtualenvs/bluewind-5kHNo6Af-py3.12/bin/activate && while true; do python local_secrets.py && source .env && env $(cat .env | xargs) python ci.py e2e_dev_green  || (terminal-notifier -message \"E2E Dev Green failed\" -title \"CI Alert\" || notify-send \"CI Alert\" \"e2e Dev Green test failed\"); sleep 1; done",
      "problemMatcher": [],
      "runOptions": {
        "runOn": "folderOpen"
      }
    },
    {
      "label": "tunnel",
      "type": "shell",
      "command": "cloudflared tunnel run my-app-tunnel",
      "problemMatcher": [],
      "runOptions": {
        "runOn": "folderOpen"
      }
    },
    {
      "label": "run-all-tasks",
      "dependsOn": [
        "prod-blue-e2e",
        "prod-blue-pull-main",
        "prod-green-e2e",
        "dev-green-server",
        "e2e-dev-green",
        "DEV",
        "tunnel"
      ],
      "dependsOrder": "parallel",
      "problemMatcher": []
    }
  ]
}
